"use strict";(self.webpackChunkhyper_react=self.webpackChunkhyper_react||[]).push([[3740],{3740:(e,s,l)=>{l.r(s),l.d(s,{default:()=>w});var i=l(9379),t=l(5043),d=l(4556),n=l(3216),a=l(3519),r=l(1072),o=l(8602),c=l(8628),u=l(4063),m=l(3722),h=l(4282),x=l(9620),v=l(2327),p=l(5995),j=l(7881),g=l(4858),b=l(4342),f=l(3767),N=l(9804),y=l(1462),A=l(579);const w=()=>{var e,s,l,w,S,z,C,k,T,I,R,P,L,M,F,H,B,W,Y,D;const{id:U}=(0,n.g)(),{state:q}=(0,n.zy)(),E=(0,d.wA)(),G=(0,n.Zp)(),O=(0,d.d4)(e=>e),_=null===O||void 0===O||null===(e=O.getChatByIdReducer)||void 0===e||null===(s=e.supportData)||void 0===s?void 0:s.chat,Z=null===O||void 0===O||null===(l=O.getChatByIdReducer)||void 0===l?void 0:l.loading,K=null===O||void 0===O||null===(w=O.updateTicketReducer)||void 0===w||null===(S=w.supportData)||void 0===S?void 0:S.status,V=null===O||void 0===O||null===(z=O.updateTicketReducer)||void 0===z?void 0:z.loading,$=(0,j.Ux)(),J=(0,t.useRef)(null),Q=(0,t.useRef)(null),X=(0,t.useRef)(null),ee=(null===_||void 0===_?void 0:_.length)-1,{register:se,handleSubmit:le,reset:ie,formState:{errors:te}}=(0,g.mN)(),[de,ne]=(0,t.useState)(""),[ae,re]=(0,t.useState)(!1),[oe,ce]=(0,t.useState)("Medium"),[ue,me]=(0,t.useState)("Pending");(0,t.useEffect)(()=>{null!==_&&void 0!==_&&_[ee]&&(ce(_[ee].priority||"Medium"),me(_[ee].status||"Pending"))},[_,ee]);const he=()=>{re(!ae),ae||setTimeout(()=>{var e;null===(e=J.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100)},xe=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"pending":return"secondary";case"resolved":return"success";case"in progress":return"warning";case"not feasible":return"danger";default:return"info"}};return(0,t.useEffect)(()=>{U&&E((0,p.x5)({id:U}))},[E,U]),(0,t.useEffect)(()=>{200===K&&(E((0,p.dh)()),E((0,p.x5)({id:U})),ie({message:""}),ne(""),re(!1))},[E,U,K]),Z?(0,A.jsx)(b.Rh,{}):(0,A.jsxs)(a.A,{fluid:!0,className:"p-2",style:{minHeight:"100vh"},children:[(0,A.jsxs)(r.A,{className:"align-items-center mb-2",children:[(0,A.jsx)(o.A,{xs:"auto",children:(0,A.jsx)("b",{children:(0,A.jsx)(N.OLK,{onClick:()=>G(-1),className:"p-2 rounded-circle",style:{width:"40px",height:"40px",border:"1px solid #dee2e6"}})})}),(0,A.jsx)(o.A,{children:(0,A.jsx)("h2",{className:"mb-0 fw-semibold",style:{color:"#212529"},children:"Ticket Details"})}),(0,A.jsx)(o.A,{children:(0,A.jsxs)("h4",{className:"text-muted",children:["Ticket: ",null===q||void 0===q?void 0:q.ticketId]})})]}),(0,A.jsxs)(r.A,{className:"g-4",children:[(0,A.jsx)(o.A,{lg:7,children:(0,A.jsxs)(c.A,{className:"h-100 border-0 shadow-sm",children:[(0,A.jsxs)(c.A.Header,{className:"bg-white border-bottom d-flex justify-content-between align-items-center py-3",children:[(0,A.jsx)("h5",{className:"mb-0 fw-semibold",style:{color:"#495057"},children:"Conversation"}),(0,A.jsx)(u.A,{pill:!0,bg:xe(null===_||void 0===_||null===(C=_[ee])||void 0===C?void 0:C.status),className:"px-3 py-2 text-capitalize",style:{fontSize:"0.75rem"},children:(null===_||void 0===_||null===(k=_[ee])||void 0===k?void 0:k.status)||"N/A"})]}),(0,A.jsxs)(c.A.Body,{className:"p-0",style:{height:"500px",overflowY:"auto",backgroundColor:"#f8f9fa"},children:[(0,A.jsx)("div",{ref:Q}),null===_||void 0===_?void 0:_.map((e,s)=>{var l,i,t;return(0,A.jsx)("div",{className:"d-flex mb-2 px-3 py-2 ".concat("sender"===(null===e||void 0===e?void 0:e.messagefrom)?"justify-content-end":"justify-content-start"),children:(0,A.jsxs)("div",{className:"p-2 rounded-3 ".concat("sender"===(null===e||void 0===e?void 0:e.messagefrom)?"bg-success text-white":"bg-white"),style:{maxWidth:"75%",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",fontSize:"0.875rem"},children:[(0,A.jsxs)("div",{className:"d-flex align-items-center mb-1",children:[(0,A.jsx)("div",{className:"rounded-circle d-flex align-items-center justify-content-center ".concat("sender"===(null===e||void 0===e?void 0:e.messagefrom)?"bg-white text-dark":"bg-secondary text-light"),style:{width:"28px",height:"28px",fontSize:"0.75rem",fontWeight:"bold",marginRight:"8px"},children:null===e||void 0===e||null===(l=e.userId)||void 0===l||null===(i=l.name)||void 0===i?void 0:i.charAt(0).toUpperCase()}),(0,A.jsxs)("div",{children:[(0,A.jsx)("span",{className:"fw-semibold",children:null===e||void 0===e||null===(t=e.userId)||void 0===t?void 0:t.name}),(0,A.jsx)("small",{className:"ms-2 ".concat("sender"===(null===e||void 0===e?void 0:e.messagefrom)?"text-white-50":"text-muted"),children:(0,f.Y)((null===e||void 0===e?void 0:e.createdAt)||(null===q||void 0===q?void 0:q.createdAt))})]})]}),(0,A.jsx)("p",{className:"mb-1",style:{lineHeight:"1.4"},children:null===e||void 0===e?void 0:e.description}),(null===e||void 0===e?void 0:e.status)&&(0,A.jsx)("div",{className:"d-flex justify-content-end mt-1",children:(0,A.jsx)(u.A,{bg:xe(null===e||void 0===e?void 0:e.status),className:"text-capitalize",style:{fontSize:"0.65rem"},children:null===e||void 0===e?void 0:e.status})})]})},s)}),(0,A.jsx)("div",{ref:J})]}),(0,A.jsx)(c.A.Footer,{className:"bg-white border-top p-3",children:ae?(0,A.jsx)(m.A,{ref:X,onSubmit:le(e=>{const s={_id:U,issueType:(null===q||void 0===q?void 0:q.issueType)||"",priority:oe||"",description:(null===e||void 0===e?void 0:e.message)||"",userId:null===$||void 0===$?void 0:$.id,senderId:null===$||void 0===$?void 0:$.id,status:ue};E((0,p.YY)(s))}),children:(0,A.jsxs)(r.A,{className:"g-2 align-items-end",children:[(0,A.jsx)(o.A,{md:5,children:(0,A.jsxs)(m.A.Group,{controlId:"statusSelect",className:"mb-2",children:[(0,A.jsx)(m.A.Label,{className:"small fw-semibold text-muted mb-1",children:"Status"}),(0,A.jsxs)(m.A.Select,(0,i.A)((0,i.A)({},se("status",{required:!0})),{},{value:ue,onChange:e=>me(e.target.value),className:"border-2",style:{borderWidth:"2px",borderColor:"#e9ecef"},children:[(0,A.jsx)("option",{value:"",disabled:!0,children:"Select Status"}),(0,A.jsx)("option",{value:"Pending",children:"Pending"}),(0,A.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,A.jsx)("option",{value:"Resolved",children:"Resolved"}),(0,A.jsx)("option",{value:"Not Feasible",children:"Not Feasible"}),(0,A.jsx)("option",{value:"Other",children:"Other"})]}))]})}),ue&&!["Resolved","NotFeasible"].includes(ue)&&(0,A.jsx)(o.A,{md:5,children:(0,A.jsxs)(m.A.Group,{controlId:"prioritySelect",className:"mb-2",children:[(0,A.jsx)(m.A.Label,{className:"small fw-semibold text-muted mb-1",children:"Priority"}),(0,A.jsxs)(m.A.Select,(0,i.A)((0,i.A)({},se("priorityType")),{},{value:oe,onChange:e=>ce(e.target.value),className:"border-2",style:{borderWidth:"2px",borderColor:"#e9ecef"},children:[(0,A.jsx)("option",{value:"Critical",children:"Critical"}),(0,A.jsx)("option",{value:"High",children:"High"}),(0,A.jsx)("option",{value:"Medium",children:"Medium"}),(0,A.jsx)("option",{value:"Low",children:"Low"})]}))]})}),(0,A.jsx)(o.A,{md:2,className:"text-end mb-2",children:(0,A.jsx)(N.Gsv,{onClick:he,className:"p-1 rounded-circle text-danger",style:{width:"40px",height:"40px",border:"1px solid #dee2e6"}})}),(0,A.jsx)(o.A,{xs:12,children:(0,A.jsx)(m.A.Group,{controlId:"messageTextarea",className:"mb-2",children:(0,A.jsx)(m.A.Control,(0,i.A)((0,i.A)({as:"textarea"},se("message",{required:!0})),{},{value:de,onChange:e=>ne(e.target.value),placeholder:"Type your message here...",className:"border-2",style:{borderWidth:"2px",borderColor:"#e9ecef",fontSize:"0.875rem",minHeight:"80px",resize:"vertical"}}))})}),(0,A.jsx)(o.A,{xs:12,className:"d-flex justify-content-end",children:(0,A.jsx)(h.A,{variant:"success",type:"submit",className:"px-3 py-1 rounded-pill d-flex align-items-center",disabled:V,style:{fontSize:"0.875rem"},children:V?(0,A.jsx)("div",{style:{width:"168px"},children:(0,A.jsx)(b.N7,{})}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(N.IkI,{className:"me-2",size:16})," Send Message"]})})})]})}):(0,A.jsx)("div",{className:"d-grid",children:(0,A.jsxs)(h.A,{variant:"outline-success",onClick:he,className:"rounded-pill py-2 d-flex align-items-center justify-content-center",style:{fontSize:"0.875rem"},children:[(0,A.jsx)(N.KcR,{className:"me-2",size:16})," Reply to Ticket"]})})})]})}),(0,A.jsx)(o.A,{lg:5,children:(0,A.jsxs)(c.A,{className:"h-100 border-0 shadow-sm",children:[(0,A.jsx)(c.A.Header,{className:"bg-white border-bottom py-3",children:(0,A.jsx)("h5",{className:"mb-0 fw-semibold",style:{color:"#495057"},children:"Ticket Overview"})}),(0,A.jsxs)(c.A.Body,{className:"p-4",children:[(0,A.jsxs)("div",{className:"mb-4",children:[(0,A.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,A.jsx)("span",{className:"small fw-semibold text-muted",children:"Ticket Status"}),(0,A.jsx)("span",{className:"small fw-semibold",children:(null===_||void 0===_||null===(T=_[ee])||void 0===T?void 0:T.status)||"Pending"})]}),(0,A.jsx)(x.A,{now:(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"pending":return 25;case"in progress":return 50;case"resolved":case"not feasible":return 100;default:return 0}})(null===_||void 0===_||null===(I=_[ee])||void 0===I?void 0:I.status),variant:xe(null===_||void 0===_||null===(R=_[ee])||void 0===R?void 0:R.status),className:"mb-3",style:{height:"6px",borderRadius:"3px"}})]}),(0,A.jsxs)("div",{className:"mb-4",children:[(0,A.jsx)("h6",{className:"fw-semibold mb-3 text-muted text-uppercase small",children:"Properties"}),(0,A.jsx)(c.A,{className:"border-0 bg-light-subtle",children:(0,A.jsx)(c.A.Body,{className:"p-3",children:(0,A.jsxs)(v.A,{gap:2,children:[(0,A.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,A.jsx)("span",{className:"small text-muted",children:"Module"}),(0,A.jsx)("span",{className:"fw-semibold text-end",style:{fontSize:"0.875rem"},children:(null===q||void 0===q?void 0:q.pageName)||"N/A"})]}),(0,A.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,A.jsx)("span",{className:"small text-muted",children:"Issue Type"}),(0,A.jsx)(u.A,{bg:"info",className:"text-uppercase",style:{fontSize:"0.75rem"},children:(null===q||void 0===q?void 0:q.issueType)||"N/A"})]}),(0,A.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,A.jsx)("span",{className:"small text-muted",children:"Priority"}),(0,A.jsx)(u.A,{bg:(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"critical":return"dark";case"high":return"danger";case"medium":return"warning";case"low":return"success";default:return"secondary"}})(null===_||void 0===_||null===(P=_[ee])||void 0===P?void 0:P.priority),className:"text-capitalize",style:{fontSize:"0.75rem"},children:(null===_||void 0===_||null===(L=_[ee])||void 0===L?void 0:L.priority)||"N/A"})]}),(0,A.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,A.jsx)("span",{className:"small text-muted",children:"Created"}),(0,A.jsx)("span",{className:"fw-semibold",style:{fontSize:"0.875rem"},children:(0,f.Y)(null===q||void 0===q?void 0:q.createdAt)})]})]})})})]}),(0,A.jsxs)("div",{className:"mb-4",children:[(0,A.jsx)("h6",{className:"fw-semibold mb-3 text-muted text-uppercase small",children:"Requester"}),(0,A.jsx)(c.A,{className:"border-0 shadow-sm",children:(0,A.jsx)(c.A.Body,{className:"p-3",children:(0,A.jsxs)("div",{className:"d-flex align-items-center",children:[null!==q&&void 0!==q&&null!==(M=q.user)&&void 0!==M&&null!==(F=M.name)&&void 0!==F&&F.charAt(0).toUpperCase()?(0,A.jsx)("div",{className:"rounded-circle d-flex align-items-center justify-content-center bg-success text-white",style:{width:"48px",height:"48px",fontSize:"1rem",fontWeight:"bold"},children:null===q||void 0===q||null===(H=q.user)||void 0===H||null===(B=H.name)||void 0===B?void 0:B.charAt(0).toUpperCase()}):"",(0,A.jsxs)("div",{className:"ms-3",children:[(0,A.jsxs)("h6",{className:"mb-0 fw-semibold",style:{fontSize:"0.9375rem"},children:[null===q||void 0===q||null===(W=q.user)||void 0===W?void 0:W.name," ",(null===q||void 0===q||null===(Y=q.user)||void 0===Y?void 0:Y.lastName)||""]}),(0,A.jsx)("small",{className:"text-muted",style:{fontSize:"0.8125rem"},children:null===q||void 0===q||null===(D=q.user)||void 0===D?void 0:D.email})]})]})})})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("h6",{className:"fw-semibold mb-3 text-muted text-uppercase small",children:"Attachment"}),null!==q&&void 0!==q&&q.attachment?(0,A.jsxs)(c.A,{className:"border-0 shadow-sm overflow-hidden",children:[(0,A.jsx)("div",{style:{height:"180px",backgroundImage:"url(".concat(null===q||void 0===q?void 0:q.attachment,")"),backgroundSize:"cover",backgroundPosition:"center",position:"relative"},children:(0,A.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",style:{backgroundColor:"rgba(0,0,0,0.3)",opacity:0,transition:"opacity 0.2s"},onMouseEnter:e=>e.currentTarget.style.opacity=1,onMouseLeave:e=>e.currentTarget.style.opacity=0,children:(0,A.jsxs)(h.A,{variant:"light",size:"sm",className:"rounded-pill d-flex align-items-center",href:null===q||void 0===q?void 0:q.attachment,target:"_blank",rel:"noopener noreferrer",children:[(0,A.jsx)(N.uSl,{className:"me-1",size:14})," View Full Size"]})})}),(0,A.jsx)(c.A.Footer,{className:"bg-white border-top py-2",children:(0,A.jsx)("small",{className:"text-muted",children:"Attached image"})})]}):(0,A.jsxs)(c.A,{className:"border-0 shadow-sm text-center py-4",children:[(0,A.jsx)(y.Mqx,{size:24,className:"text-muted mb-2"}),(0,A.jsx)("p",{className:"mb-0 text-muted small",children:"No attachments"})]})]})]})]})})]})]})}},3767:(e,s,l)=>{l.d(s,{Y:()=>i});const i=e=>{if(!e)return"";const s=e.replace(/T00:00:00\.000Z*T00:00:00$/,"T00:00:00.000Z"),l=new Date(s);return isNaN(l)?"Invalid Date":l.toLocaleString("en-US",{weekday:"short",month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}}}]);
//# sourceMappingURL=3740.b263d619.chunk.js.map